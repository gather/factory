/*! factory 1.0.0 */
var Factory;Factory=function(){function a(){}return a.factories={},a.buildFn=function(a,b){return b},a.createFn=function(a,b){return b},a.clear=function(){return this.factories={},this.buildFn=function(a,b){return b},this.createFn=function(a,b){return b}},a.reset=function(){var a,b,c,d;c=this.factories,d=[];for(b in c)a=c[b],d.push(a.sequences={});return d},a.define=function(a,b){var c;return c=new FactoryDefinition(a,this.buildFn,this.createFn),"function"==typeof b&&b.call(c),this.factories[a]=c},a.getFactory=function(a){var b;return b=this.factories[a],null!=b?b:{factory:function(){throw new Error('undefined factory "'+a+'"')}()}},a.getTrait=function(a,b){var c;return c=a.traits[b],null!=c?c:{trait:function(){throw new Error('undefined trait "'+b+'" for factory "'+this.name+'"')}.call(this)}},a.abstractBuild=function(a,b,c){var d,e,f,g,h;return a=a.split(/\s+/),f=a[0],e=this.getFactory(f),h=a.slice(1,+a.length+1||9e9).map(function(a){return function(b){return a.getTrait(e,b)}}(this)),d=e.attributes(b,h),g=c?e[c](f,d.withoutIgnored):d.withoutIgnored,h.unshift(e),h.map(function(a){return a.applyCallbacks(g,d.withIgnored)}),g},a.attributes=function(a,b){return this.abstractBuild(a,b)},a.build=function(a,b){return this.abstractBuild(a,b,"build")},a.create=function(a,b){return this.abstractBuild(a,b,"create")},a.buildList=function(a,b,c){var d;return function(){d=[];for(var a=0;b>=0?b>a:a>b;b>=0?a++:a--)d.push(a);return d}.apply(this).map(function(b){return function(){return b.build(a,c)}}(this))},a.createList=function(a,b,c){var d;return function(){d=[];for(var a=0;b>=0?b>a:a>b;b>=0?a++:a--)d.push(a);return d}.apply(this).map(function(b){return function(){return b.create(a,c)}}(this))},a.buildWith=function(a){return this.buildFn=a},a.createWith=function(a){return this.createFn=a},a}(),("undefined"!=typeof module&&null!==module?module.exports:void 0)?module.exports=Factory:window.Factory=Factory;var FactoryDefinition,__slice=[].slice;FactoryDefinition=function(){function a(a,b,c){this.name=a,this.build=b,this.create=c,this.attrs={},this.ignores={},this.sequences={},this.traits={},this.callbacks=[]}return a.prototype.buildWith=function(a){return this.build=a},a.prototype.createWith=function(a){return this.create=a},a.prototype.after=function(a){return this.callbacks.push(a)},a.prototype.attr=function(a,b){return this.attrs[a]="function"==typeof b?b:function(){return b}},a.prototype.ignore=function(a,b){return this.ignores[a]="function"==typeof b?b:function(){return b}},a.prototype.sequence=function(a,b){var c;return c=this,b=b||function(a){return a},this.attrs[a]=function(){return c.sequences[a]=c.sequences[a]||0,b.call(this,++c.sequences[a])}},a.prototype.trait=function(b,c){var d;return d=new a(b,this.buildFn,this.createFn),"function"==typeof c&&c.call(d),this.traits[b]=d},a.prototype.attributes=function(a,b){var c,d,e;d=this.hash.merge({},a),e={},b.forEach(function(a){var b,c;c=[];for(b in a.attrs)c.push(d[b]=a.attrs[b]);return c});for(c in this.attrs)d.hasOwnProperty(c)||(d[c]=this.attrs[c]);for(c in this.ignores)e[c]=d.hasOwnProperty(c)?d[c]:this.ignores[c],delete d[c];return this.hash.evaluate(d),this.hash.evaluate(e),{withIgnored:this.hash.merge({},d,e),withoutIgnored:d}},a.prototype.applyCallbacks=function(a,b){return this.callbacks.forEach(function(c){return c.call(a,b)})},a.prototype.hash={merge:function(){var a,b,c,d,e,f,g;for(a=arguments[0],d=2<=arguments.length?__slice.call(arguments,1):[],f=0,g=d.length;g>f;f++){c=d[f];for(b in c)e=c[b],a[b]=e}return a},evaluate:function(a){var b,c;c=[];for(b in a)c.push(a[b]="function"==typeof a[b]?a[b]():a[b]);return c}},a}();